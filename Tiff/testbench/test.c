#include <stdio.h>

// Test vectors for the VM, generated by stepping the VM one group at a time,
// starting at address 0.
// Command in Tiff is "N make ../templates/testbench.c ../testbench/test.c".
// Note that the registers/stacks will be hosed after test vector generation.

// Test vectors are embedded in a function
// Register IDs: 0 to 5 = T, N, RP, SP, UP, PC

int errors = 0;

void newstep(uint32_t IR, int testID);
void changes(int Reg, uint32_t previous, uint32_t actual);

int main()
{
//       INS_GROUP  Test#
newstep(0x4C0001D1, 0);  //// PC = 0000h
changes(5, 0x00000000, 0x00000744);
newstep(0x6C0001C5, 1);  //// PC = 1D10h
changes(2, 0x00002100, 0x000020FC);
changes(5, 0x00000748, 0x00000714);
newstep(0x1B902218, 2);  //// PC = 1C50h
changes(0, 0x00000000, 0x00002218);
changes(1, 0x00000000, 0x00000748);
changes(2, 0x000020FC, 0x00002100);
changes(3, 0x00002080, 0x00002078);
newstep(0x96BE6200, 3);  //// PC = 1C60h
changes(0, 0x00002218, 0x00002200);
changes(1, 0x00000748, 0x00000000);
changes(3, 0x00002078, 0x0000207C);
newstep(0xF7902100, 4);  //// PC = 1C70h
changes(0, 0x00002200, 0x00002100);
changes(4, 0x00002100, 0x00002200);
newstep(0x0790000C, 5);  //// PC = 1C80h
changes(0, 0x00002100, 0x0000000C);
changes(1, 0x00000000, 0x00002100);
changes(3, 0x0000207C, 0x00002074);
newstep(0xEA5AF540, 6);  //// PC = 1C90h
changes(0, 0x0000000C, 0x00002100);
changes(1, 0x00002100, 0x00000000);
changes(3, 0x00002074, 0x00002100);
newstep(0xE40021F0, 7);  //// PC = 1CA0h
changes(0, 0x00002100, 0x000021F0);
changes(1, 0x00000000, 0x00002100);
changes(3, 0x00002100, 0x000020FC);
newstep(0x07900008, 8);  //// PC = 1CB0h
changes(0, 0x000021F0, 0x00000008);
changes(1, 0x00002100, 0x000021F0);
changes(3, 0x000020FC, 0x000020F4);
newstep(0xEA5AF904, 9);  //// PC = 1CC0h
changes(0, 0x00000008, 0x00000004);
changes(3, 0x000020F4, 0x000020F8);
newstep(0x2ED6C0CA, 10);  //// PC = 1CD0h
changes(0, 0x00000004, 0x00002100);
changes(1, 0x000021F0, 0x00000000);
changes(2, 0x00002100, 0x000021E8);
changes(3, 0x000020F8, 0x00002100);
changes(5, 0x00000738, 0x00000328);
newstep(0x09000000, 11);  //// PC = 0CA0h
changes(2, 0x000021E8, 0x000021EC);
changes(5, 0x0000032C, 0x00000738);
newstep(0x6C0000ED, 12);  //// PC = 1CE0h
changes(2, 0x000021EC, 0x000021E8);
changes(5, 0x0000073C, 0x000003B4);
newstep(0xE40003A0, 13);  //// PC = 0ED0h
changes(0, 0x00002100, 0x000003A0);
changes(1, 0x00000000, 0x00002100);
changes(3, 0x00002100, 0x000020FC);
newstep(0xE4002234, 14);  //// PC = 0EE0h
changes(0, 0x000003A0, 0x00002234);
changes(1, 0x00002100, 0x000003A0);
changes(3, 0x000020FC, 0x000020F8);
newstep(0x96B09000, 15);  //// PC = 0EF0h
changes(0, 0x00002234, 0x00002100);
changes(1, 0x000003A0, 0x00000000);
changes(2, 0x000021E8, 0x000021EC);
changes(3, 0x000020F8, 0x00002100);
changes(5, 0x000003C0, 0x0000073C);
newstep(0xE4002218, 16);  //// PC = 1CF0h
changes(0, 0x00002100, 0x00002218);
changes(1, 0x00000000, 0x00002100);
changes(3, 0x00002100, 0x000020FC);
newstep(0xB9A4C047, 17);  //// PC = 1D00h
changes(0, 0x00002218, 0x00002100);
changes(1, 0x00002100, 0x00000000);
changes(2, 0x000021EC, 0x000021E8);
changes(3, 0x000020FC, 0x00002100);
changes(5, 0x00000744, 0x0000011C);
newstep(0xE400000A, 18);  //// PC = 0470h
changes(0, 0x00002100, 0x0000000A);
changes(1, 0x00000000, 0x00002100);
changes(3, 0x00002100, 0x000020FC);
newstep(0xE4002218, 19);  //// PC = 0480h
changes(0, 0x0000000A, 0x00002218);
changes(1, 0x00002100, 0x0000000A);
changes(3, 0x000020FC, 0x000020F8);

printf("%d errors\n", errors);
return 0;
}
